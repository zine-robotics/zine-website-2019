if (self.CavalryLogger) { CavalryLogger.start_js(["vTBIN"]); }

__d("PhotoUploadResolution",[],(function(a,b,c,d,e,f){e.exports={STANDARD:"standard",HIGH:"high"}}),null);
__d("FBAnimatedProgressBar.react",["cx","Animation","React","ReactDOM","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;var h=300;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.componentDidMount=function(){this.$1=null,this.$2=b("ReactDOM").findDOMNode(this).offsetWidth};d.componentDidUpdate=function(a,c){if(a.percent==this.props.percent)return;c=this.props.percent;a=this.props.duration;c=parseInt(this.$2,10)*parseInt(c,10)/100;this.$1||(this.$1=new(b("Animation"))(b("ReactDOM").findDOMNode(this.refs.fill)));this.$1.stop().to("width",parseInt(c,10)).duration(this.props.animate?Math.max(parseInt(a,10),h):0).ondone(this.props.onComplete).go()};d.componentWillUnmount=function(){this.$1&&this.$1.stop()};d.render=function(){var a=b("joinClasses")(this.props.className,"_1c5");return b("React").createElement("div",{className:a},b("React").createElement("div",{className:"_1c6",ref:"fill"}))};return c}(b("React").Component);c.propTypes={className:a.string,duration:a.number.isRequired,percent:a.number.isRequired,onComplete:a.func};e.exports=c}),null);
__d("DickensErrorLogging",["ErrorSignal","ErrorUtils"],(function(a,b,c,d,e,f){a={init:function(a){b("ErrorUtils").addListener(function(c){b("ErrorSignal").logJSError("dickens",{error:c.name||c.message,extra:c,qn:a})})}};e.exports=a}),null);
__d("PhotoUploadConnectionMonitor",["EventEmitter","Network","SubscriptionsHandler"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this)||this;c.$PhotoUploadConnectionMonitor1=new(b("SubscriptionsHandler"))();return c}var d=c.prototype;d.start=function(){this.$PhotoUploadConnectionMonitor1.addSubscriptions(b("Network").addListener("online",this.online.bind(this)),b("Network").addListener("offline",this.offline.bind(this)));return this};d.reset=function(){this.$PhotoUploadConnectionMonitor1.release()};d.online=function(){this.emit("online")};d.offline=function(){this.emit("offline")};d.isOnline=function(){return b("Network").isOnline()};return c}(b("EventEmitter"));e.exports=a}),null);
__d("UploadProgress",["Bootloader","PhotosUploadWaterfall"],(function(a,b,c,d,e,f){__p&&__p();var g=a.URL||a.webkitURL||{},h=function(){"use strict";__p&&__p();function a(a){__p&&__p();var c=this;this.uploadID=a.uploadID;this.size=a.size;this.sizeUploaded=null;this.timeStarted=null;this.isUploading=!1;this.lastProgress=null;this.processingTime=null;this.timeUploaded=null;this.sourceImageHeight=null;this.sourceImageWidth=null;this.projectionType="";if(a.file)try{b("Bootloader").loadModules(["SphericalImage"],function(b){if(g.createObjectURL){var d=new Image();d.onload=function(){c.sourceImageHeight=d.height,c.sourceImageWidth=d.width};d.src=g.createObjectURL(a.file)}b.createFromBlob(a.file).then(function(a){c.projectionType=a.getProjectionType()})["catch"](function(a){}).done()},"UploadProgress")}catch(a){}}var c=a.prototype;c.isPending=function(){return!this.isUploading&&!this.timeUploaded};c.updateProgress=function(a,b){this.isProcessed()||(this.lastProgress=a);a=b-this.sizeUploaded;this.sizeUploaded=b;return a};c.startProgress=function(a){this.timeStarted=a,this.isUploading=!0};c.finishProgress=function(a){this.lastProgress!==null&&(this.processingTime=a-this.lastProgress);var b=this.updateProgress(a,this.size);this.timeUploaded=a;this.isUploading=!1;return b};c.isProcessed=function(){return this.processingTime!==null};return a}();c=function(){"use strict";__p&&__p();function a(a,b){this._config=a||{},this._logWaterfallStep=b||function(){},this._sumBytes=0,this._sumBytesUploaded=0,this._timeStarted=null,this._timeFinished=null,this._timeLastStarted=null,this._timeElapsedUploading=0,this._estimatedProcessingTime=null,this._numUploading=0,this._numWaiting=0,this._rawState={}}var c=a.prototype;c.destroy=function(){for(var a in this._rawState)Object.prototype.hasOwnProperty.call(this._rawState,a)&&this.remove(this._rawState.uploadID)};c.getStats=function(){return this.getState()};c.getState=function(){return{timeStarted:this._timeStarted,timeFinished:this._timeFinished,timeElapsedUploading:this._timeElapsedUploading,sumBytes:this._sumBytes,sumBytesUploaded:this._sumBytesUploaded,estimatedBandwidth:this.getEstimatedTotalSpeed()}};c.getTotalBytes=function(){return this._sumBytes};c.getTotalUploadedBytes=function(){return this._sumBytesUploaded};c.getEstimatedSingleUploadSpeed=function(a){return this._numUploading?this.getEstimatedTotalSpeed(a)/this._numUploading:this.getEstimatedTotalSpeed(a)};c.getEstimatedTotalSpeed=function(a){a=a!==void 0?a:Date.now();var b=this._timeElapsedUploading;this._timeLastStarted!==null&&(b+=a-this._timeLastStarted);return b>0?this._sumBytesUploaded/b:0};c.getEstimatedSingleUploadTimeRemaining=function(a,b){var c=this.getUploadState(a).sizeUploaded||0;a=this.getUploadState(a).size-c;c=this.getEstimatedSingleUploadSpeed(b);return c>0?a/c+this.getEstimatedProcessingTime():2e4};c.getEstimatedTotalTimeRemaining=function(a){a=this.getEstimatedTotalSpeed(a);return a>0?(this._sumBytes-this._sumBytesUploaded)/a+this.getEstimatedTotalProcessingTime():2e4*(this._numWaiting+this._numUploading)};c.addFiles=function(a){a.forEach(this.addFile.bind(this))};c.addSelections=function(a){a.forEach(this.addSelection.bind(this))};c.addSelection=function(a){this.addFile({uploadID:a.getSelectionContainerID(),size:a.getSize()})};c.addFile=function(a){this._rawState[a.uploadID]||(this._sumBytes+=a.size,this._numWaiting+=1,this._rawState[a.uploadID]=new h(a))};c.remove=function(a){var b=this.getUploadState(a);if(!b&&this._config.ignoreMissingState)return;this._sumBytes-=b.size;this._sumBytesUploaded-=b.sizeUploaded;b.isUploading?this._numUploading--:this._numWaiting--;delete this._rawState[a]};c.updateUploaded=function(a,b){b=b!==void 0?b:Date.now();a=this.getUploadState(a);this._updateOverallProgress(a.finishProgress(b));this._updateEstimatedProcessingTime(a.processingTime);this._numUploading--;this.isUploadingDone()&&this._finishUploading(b)};c._finishUploading=function(a){this._timeFinished=a,this._timeElapsedUploading+=a-this._timeLastStarted,this._timeLastStarted=null};c.isUploadingDone=function(){return!this._numUploading&&this._timeLastStarted!==null};c.updateProgress=function(a,b,c){c=c!==void 0?c:Date.now();a=this.getUploadState(a);a.isPending()&&this._startUpload(c,a);this._updateOverallProgress(a.updateProgress(c,b))};c._startUpload=function(a,b){b.startProgress(a),this._numWaiting--,this._numUploading++,this._timeStarted===null&&(this._timeStarted=a),this._timeLastStarted===null&&(this._timeLastStarted=a)};c._updateOverallProgress=function(a){this._sumBytesUploaded+=a};c.getEstimatedProcessingTime=function(){return this._estimatedProcessingTime===null?a.FALLBACK_PROCESSING_DURATION_ESTIMATION:this._estimatedProcessingTime};c.getEstimatedTotalProcessingTime=function(){var a=this._numUploading||1;return(this._numWaiting+this._numUploading)*this.getEstimatedProcessingTime()/a};c._updateEstimatedProcessingTime=function(a){var b=.2;this._estimatedProcessingTime=this._estimatedProcessingTime===null?a:this._estimatedProcessingTime*(1-b)+a*b};c.getUploadStats=function(){return this.getUploadState.apply(this,arguments)};c.getUploadState=function(a){var c=this._rawState[a];c||this._logWaterfallStep(b("PhotosUploadWaterfall").MISSING_UPLOAD_STATE||120,{uploadID:a,uploadProgressState:Object.keys(this._rawState)});return c};return a}();c.FALLBACK_UPLOAD_DURATION_ESTIMATION=2e4;c.FALLBACK_PROCESSING_DURATION_ESTIMATION=5e3;e.exports=c}),null);
__d("UploadController",["invariant","ArbiterMixin","AsyncRequest","PhotosConst","PhotosUploadWaterfall","PhotosUploadWaterfallMixin","PhotosUploadWaterfallXMixin","PhotoUploadResolution","PUWSteps","UploadProgress","mixin"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d){__p&&__p();var e;e=a.call(this)||this;e.$UploadController1=babelHelpers["extends"]({},d);e.$UploadController2=null;e.$UploadController3=c;e.$UploadController4=new(b("UploadProgress"))(d.uploadProgressConfig,e.logWaterfallStep.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController5={numTotal:0,numResizing:0,numUploading:0,numFailed:0,numUploaded:0,numResized:0,numCanceled:0,numDeleted:0};e.$UploadController6=d.isHighQuality;e.$UploadController7={};e.$UploadController3.subscribe("resize_start",e.$UploadController8.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("resize_hires_start",e.$UploadController8.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("resize_done",e.$UploadController9.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("upload_start",e.$UploadController10.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("upload_hires_attach",e.$UploadController11.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("upload_done",e.$UploadController12.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("upload_progress",e.$UploadController13.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("upload_failed",e.$UploadController14.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("upload_retry",e.$UploadController15.bind(babelHelpers.assertThisInitialized(e)));e.$UploadController3.subscribe("canceled_photo_uploaded",e.$UploadController16.bind(babelHelpers.assertThisInitialized(e)));return e}var d=c.prototype;d.logWaterfallStep=function(b,c,d){c=c||{},c.scuba_tags=c.scuba_tags||{},c.scuba_tags.is_set=!!this.$UploadController1.photoSetToken,c.scuba_tags.is_page=this.$UploadController1.isPage,a.prototype.logWaterfallStep.call(this,b,c,d)};d.getWaterfallConfig=function(){return{waterfallID:this.getWaterfallID(),waterfallApp:this.getUploaderApp()}};d.getUploaderApp=function(){return this.$UploadController1.uploaderName};d.getWaterfallID=function(){return this.$UploadController1.qn};d.getWaterfallAppName=function(){return this.$UploadController1.uploaderNameX};d.getWaterfallSource=function(){return this.$UploadController1.ref};d.getNumSelected=function(){return this.$UploadController5.numTotal-this.$UploadController5.numCanceled-this.$UploadController5.numFailed-this.$UploadController5.numDeleted};d.getEstimatedUploadTimeRemaining=function(a){return this.$UploadController4.getEstimatedSingleUploadTimeRemaining(a)};d.getEstimatedTotalTimeRemaining=function(){return this.$UploadController4.getEstimatedTotalTimeRemaining()};d.getNumUploaded=function(){return this.$UploadController5.numUploaded};d.getNumCanceled=function(){return this.$UploadController5.numCanceled};d.getNumResized=function(){return this.$UploadController5.numResized};d.getNumFailed=function(){return this.$UploadController5.numFailed};d.getNumTotal=function(){return this.$UploadController5.numTotal-this.$UploadController5.numCanceled};d.getUploadStats=function(){return this.$UploadController5};d.isUploading=function(){return this.$UploadController5.numTotal>this.$UploadController5.numUploaded+this.$UploadController5.numFailed+this.$UploadController5.numCanceled};d.getPercentComplete=function(){var a=this.$UploadController4.getTotalUploadedBytes(),b=this.$UploadController4.getTotalBytes();return a/b*100};d.getFilenameByUploadID=function(a){a=this.$UploadController7[a];return a&&a.name};d.setNumSelected=function(a){this.$UploadController3.setNumSelected&&this.$UploadController3.setNumSelected(a)};d.preregisterSwf=function(a){this.$UploadController3.preregisterSwf&&this.$UploadController3.preregisterSwf(a)};d.setFBID=function(a){this.addPostParam("album_fbid",a)};d.setShouldUseReactComponent=function(a,b,c){if(!a&&b)throw new Error("Can't fetch tagging source if react component props is not fetched");this.addPostParam("editable_photo",!!a);this.addPostParam("tagging_source",!!b);this.addPostParam("legacy_mentions_input",!!c);return this};d.setShouldCopyLocation=function(a){this.addPostParam("should_copy_location",!!a);return this};d.$UploadController17=function(a){this.$UploadController4.addFiles(a),this.$UploadController5.numTotal+=a.length,this.setNumSelected(this.getNumSelected()),this.$UploadController18={numTotal:a.length,numFailed:0,numUploaded:0},this.inform("queued",{files:a}),this.logStep(b("PUWSteps").CLIENT_TRANSFER_BATCH_BEGIN,{volume:a.length})};d.uploadFiles=function(a,c){var d=this;if(this.$UploadController1.albumPhotoLimit>=0&&a.length+this.getNumSelected()>this.$UploadController1.albumPhotoLimit){var e=Math.max(this.$UploadController1.albumPhotoLimit-this.getNumSelected(),0);a=a.slice(0,e);this.albumLimitExceeded()}this.logWaterfallStep(b("PhotosUploadWaterfall").IMAGES_SELECTED,{count:a.length});a.length&&(a.forEach(function(a){return d.$UploadController7[a.uploadID]=a}),this.$UploadController17(a),this.$UploadController3.uploadFiles(a,c))};d.uploadSelections=function(a,b){a.length&&(this.$UploadController4.addSelections(a),this.$UploadController5.numTotal+=a.length,this.setNumSelected(this.getNumSelected()),this.inform("queued",{selections:a}),this.$UploadController3.uploadSelections(a,b))};d.addPostParam=function(a,b){this.$UploadController3.addPostParam(a,b)};d.markDeleted=function(a){this.$UploadController5.numDeleted++,this.setNumSelected(this.getNumSelected())};d.cancelIndividualUpload=function(a){this.$UploadController5.numCanceled++,this.setNumSelected(this.getNumSelected()),this.$UploadController3.cancelIndividualUpload(a),this.logWaterfallStep(b("PhotosUploadWaterfall").CANCEL_INDIVIDUAL_UPLOAD),this.$UploadController19()&&this.$UploadController20()};d.retryFailedUpload=function(a){this.$UploadController5.numFailed--;this.$UploadController5.numTotal--;this.setNumSelected(this.getNumSelected());var b=this.$UploadController7[a];b||g(0,4242);this.$UploadController17([b]);this.$UploadController3.retryFailedUpload(a)};d.$UploadController8=function(a,c){this.$UploadController5.numResizing++,this.logWaterfallStep(b("PhotosUploadWaterfall").ONE_RESIZING_START),this.logStep(b("PUWSteps").CLIENT_UPLOAD_BEGIN),this.logStep(b("PUWSteps").CLIENT_PROCESS_BEGIN),this.inform(a,c)};d.$UploadController9=function(a,c){this.$UploadController5.numResizing--;this.$UploadController5.numResized++;this.logWaterfallStep(b("PhotosUploadWaterfall").ONE_RESIZING_DONE,c.scubaData);a=c.scubaData.scuba_ints;c.error?this.logStep(b("PUWSteps").CLIENT_PROCESS_FAIL,{dt:a.timeResizing||a.dt,bytes:a.resizedSize,error_code:c.error.message}):this.logStep(b("PUWSteps").CLIENT_PROCESS_SUCCESS,{dt:a.timeResizing||a.dt,media_data_size:a.originalSize,bytes:a.resizedSize,custom_tags:{skipped_resizing:c.scubaData.scuba_tags.skippedResizing}})};d.$UploadController10=function(a,c){this.logWaterfallStep(b("PhotosUploadWaterfall").ONE_UPLOAD_START,{scuba_ints:{size:c.size},scuba_tags:{is_retry:!!c.retry,high_quality:this.$UploadController6}}),this.logStep(b("PUWSteps").CLIENT_TRANSFER_BEGIN,{bytes:c.size}),this.$UploadController5.numUploading++,this.$UploadController4.remove(c.uploadID),this.$UploadController4.addFile(c),this.$UploadController4.updateProgress(c.uploadID,0),c.resolution=this.$UploadController6?b("PhotoUploadResolution").HIGH:b("PhotoUploadResolution").STANDARD,this.inform(a,c)};d.$UploadController11=function(a,c){this.$UploadController4.remove(c.uploadID),this.$UploadController4.addFile(c),this.$UploadController5.numUploaded--,c.resolution=b("PhotoUploadResolution").HIGH,this.$UploadController10("upload_hires_attach",c)};d.$UploadController13=function(a,b){this.$UploadController4.updateProgress(b.uploadID,b.bytesTransferred),this.inform("upload_progress",b)};d.$UploadController12=function(a,c){__p&&__p();this.$UploadController5.numUploading--;this.$UploadController5.numUploaded++;this.$UploadController18.numUploaded++;this.$UploadController4.updateUploaded(c.uploadID);a=this.$UploadController4.getUploadState?this.$UploadController4.getUploadState(c.uploadID):this.$UploadController4.getUploadStats(c.uploadID);var d=a.timeUploaded-a.timeStarted;this.logWaterfallStep(b("PhotosUploadWaterfall").ONE_UPLOAD_DONE,{meta:c.meta,scuba_ints:{uploadSize:a.size,bytesTransferred:a.sizeUploaded,retriesNeeded:c.retriesNeeded,timeSpent:d,serverProcessingTime:a.processingTime},scuba_tags:{high_quality:this.$UploadController6}});this.logStep(b("PUWSteps").CLIENT_TRANSFER_SUCCESS,{bytes:a.sizeUploaded,auto_retry_count:c.retriesNeeded,dt:d,fbid:c.response&&c.response.fbid,sheight:a.sourceImageHeight,swidth:a.sourceImageWidth,projection_type:a.projectionType});this.logStep(b("PUWSteps").CLIENT_UPLOAD_SUCCESS,{fbid:c.response.fbid});this.inform("upload_done",c);this.$UploadController19()&&this.$UploadController20()};d.$UploadController14=function(a,c){__p&&__p();this.$UploadController5.numUploading--;this.$UploadController5.numFailed++;this.setNumSelected(this.getNumSelected());this.$UploadController18.numFailed++;a=this.$UploadController4.getUploadState?this.$UploadController4.getUploadState(c.uploadID):this.$UploadController4.getUploadStats(c.uploadID);this.logWaterfallStep(b("PhotosUploadWaterfall").CLIENT_ERROR,{code:c.response.error,errorSummary:c.response.errorSummary,errorDescription:c.response.errorDescription,meta:c.meta,scuba_ints:{uploadSize:a.size,bytesTransferred:a.sizeUploaded,retriesNeeded:c.retriesNeeded,timeSpent:Date.now()-a.timeStarted}});this.$UploadController21(c);this.logStep(b("PUWSteps").CLIENT_UPLOAD_FAIL,{dt:Date.now()-a.timeStarted,error_code:c.response_error,bytes:a.sizeUploaded,auto_retry_count:c.retriesNeeded,sheight:a.sourceImageHeight,swidth:a.sourceImageWidth,projection_type:a.projectionType});this.$UploadController4.remove(c.uploadID);this.inform("upload_failed",c);this.$UploadController19()&&this.$UploadController20()};d.$UploadController15=function(a,b){this.$UploadController21(b)};d.$UploadController16=function(a,c){a={fbid:c,version:b("PhotosConst").BULK_EDITOR,confirmed:!0};new(b("AsyncRequest"))().setURI("/ajax/photos/photo/delete/dialog.php").setData(a).send()};d.$UploadController21=function(a){var c=this.$UploadController4.getUploadState?this.$UploadController4.getUploadState(a.uploadID):this.$UploadController4.getUploadStats(a.uploadID);this.logStep(b("PUWSteps").CLIENT_TRANSFER_FAIL,{dt:Date.now()-c.timeStarted,error_code:a.response_error,bytes:c.sizeUploaded,auto_retry_count:a.retriesNeeded})};d.$UploadController19=function(){return this.$UploadController5.numUploaded>0&&this.$UploadController5.numUploaded+this.$UploadController5.numFailed+this.$UploadController5.numCanceled===this.$UploadController5.numTotal};d.$UploadController20=function(){this.logWaterfallStep(b("PhotosUploadWaterfall").ALL_UPLOADS_DONE),this.$UploadController18.numUploaded===this.$UploadController18.numTotal?this.logStep(b("PUWSteps").CLIENT_TRANSFER_BATCH_SUCCESS):this.logStep(b("PUWSteps").CLIENT_TRANSFER_BATCH_FAIL,{volume:this.$UploadController18.numFailed}),this.inform("finished")};d.getStats=function(){return babelHelpers["extends"]({},this.$UploadController5,this.$UploadController4.getState?this.$UploadController4.getState():this.$UploadController4.getStats())};d.setHiRes=function(a){this.$UploadController6=a,this.$UploadController3.setHiRes(a),this.logWaterfallStep(b("PhotosUploadWaterfall").CHANGE_PHOTO_QUALITY_SETTING,{scuba_tags:{high_quality:a}})};d.setAlbumSize=function(a){this.$UploadController2===null&&(this.$UploadController2=a)};d.isModified=function(){return this.isUploading()||this.$UploadController5.numUploaded};d.cancelUpload=function(){this.$UploadController3.cancelAllUploads(),this.$UploadController5.numUploading=0,this.$UploadController5.numResizing=0,this.$UploadController5.numFailed=0};d.albumLimitExceeded=function(){this.inform("album_limit_exceeded")};d.sessionLimitExceeded=function(){this.inform("session_limit_exceeded")};return c}(b("mixin")(b("ArbiterMixin"),b("PhotosUploadWaterfallMixin"),b("PhotosUploadWaterfallXMixin")));e.exports=a}),null);
__d("SphericalMediaGyroIcon.react",["fbt","ix","Image.react","React","asset"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=g._("360 photo");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props.isEnabled?h("411966"):h("95830");return b("React").createElement(b("Image.react"),{className:this.props.className,src:a,alt:i})};return c}(b("React").PureComponent);a.defaultProps={isEnabled:!0};e.exports=a}),null);